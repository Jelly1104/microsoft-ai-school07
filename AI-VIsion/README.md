# Azure AI Vision을 활용한 이미지 분석 서비스 프로젝트

## 1. 학습 목표

- **클라우드 AI 서비스 활용:** Microsoft Azure의 Cognitive Services 중 Vision API를 사용하여 이미지로부터 다양한 정보를 추출하는 방법을 학습합니다.
- **REST API 통신:** `requests` 라이브러리를 사용하여 이미지 URL을 전송하고, Vision API의 다양한 기능(객체 탐지, 캡션 생성 등)을 파라미터로 제어하며 API를 호출하는 기술을 익힙니다.
- **이미지 처리 및 시각화:** `Pillow(PIL)` 라이브러리를 사용하여 URL로부터 이미지를 불러오고, API가 반환한 좌표 값(Bounding Box)을 기반으로 이미지 위에 사각형과 텍스트를 그려 분석 결과를 시각화하는 방법을 배웁니다.
- **코드 함수화 및 모듈화:** 반복적인 API 요청 및 이미지 처리 로직을 재사용 가능한 함수로 만들어 코드의 가독성과 효율성을 높이는 과정을 학습합니다.
- **대화형 웹 UI 구축:** `gradio` 라이브러리를 사용하여 사용자가 직접 이미지 URL을 입력하고 분석 옵션을 선택할 수 있는 인터랙티브 웹 애플리케이션을 구축하는 능력을 기릅니다.

## 2. 프로젝트 개요

이 프로젝트는 사용자가 제공한 이미지 URL을 Azure AI Vision 서비스로 전송하여, 이미지에 대한 다각적인 분석을 수행하는 웹 애플리케이션을 개발하는 것을 목표로 합니다. 사용자는 객체 탐지(Objects), 이미지 캡셔닝(Caption), 태그 추출(Tags) 등 원하는 분석 기능을 선택할 수 있습니다. 서비스는 분석 결과를 두 가지 형태로 제공합니다. 첫째, 원본 이미지 위에 탐지된 객체의 위치를 사각형으로 표시하고 라벨을 붙여 시각적으로 보여줍니다. 둘째, 이미지에 대한 설명(캡션)과 주요 키워드(태그)를 텍스트로 요약하여 제공합니다. 이 모든 기능은 `gradio`로 제작된 사용하기 쉬운 웹 인터페이스를 통해 제공됩니다.

## 3. 파일 구성 및 설명

- **`0702+vision+강사님.ipynb`**: 프로젝트 1일차 파일입니다. Azure Vision API에 이미지 분석을 요청하는 기본적인 방법을 학습하고, `Pillow` 라이브러리를 사용하여 반환된 결과(객체 위치)를 이미지에 직접 그려보는 과정을 다룹니다.
- **`0703+vision+함수화+gradio_강사님2.ipynb`**: 프로젝트 2일차 파일입니다. 1일차의 코드를 기능별로 함수화하여 재사용성을 높이고, `gradio`를 도입하여 사용자가 직접 이미지 URL과 분석 옵션을 선택할 수 있는 동적인 웹 UI를 구축하고 전체 서비스를 완성합니다.

## 4. 서비스 설계

이 프로젝트는 사용자 입력, API 분석, 결과 시각화의 세 단계로 구성된 파이프라인 형태로 설계되었습니다.

1.  **사용자 입력 (Gradio UI):**
    - 사용자는 `gradio`로 만들어진 웹 UI에 분석하고 싶은 이미지의 URL을 입력합니다.
    - 체크박스를 통해 `objects`, `caption`, `tags`, `smartCrops` 등 원하는 분석 기능을 하나 이상 선택합니다.
    - 특정 기능(캡션, 스마트 자르기) 선택 시, 관련된 세부 옵션(성 중립적 캡션, 자르기 비율)이 동적으로 활성화됩니다.
2.  **이미지 분석 (Azure Vision API):**
    - `request_image_analysis` 함수가 호출되어, 입력된 URL과 선택된 기능 목록을 포함한 요청을 Azure Vision API 엔드포인트로 전송합니다.
    - API는 이미지를 분석하고, 요청된 기능에 대한 결과(객체 정보, 캡션, 태그 등)를 JSON 형식으로 반환합니다.
3.  **결과 처리 및 시각화:**
    - **시각 결과 생성:** `draw_image` 함수는 원본 이미지를 내려받은 후, JSON 데이터에서 객체의 좌표와 라벨을 추출하여 이미지 위에 사각형과 텍스트를 그립니다.
    - **텍스트 결과 생성:** `get_result_text` 함수는 JSON 데이터에서 캡션과 태그 정보를 추출하여 사람이 읽기 쉬운 형태의 문자열로 가공합니다.
4.  **결과 출력 (Gradio UI):**
    - 처리된 시각 결과(분석 정보가 그려진 이미지)와 텍스트 결과(캡션, 태그 요약)가 `gradio` UI의 출력 컴포넌트에 표시되어 사용자에게 제공됩니다.

## 5. 주요 실행 과정 및 결과

- **(1일차) API 기본 연동:**
    - `requests.post`를 사용하여 특정 이미지 URL을 Azure Vision API로 보내고, 객체 탐지(`objects`) 결과를 JSON 형태로 받는 데 성공했습니다.
    - `Pillow`를 사용하여 이미지 위에 API가 반환한 바운딩 박스 좌표에 맞춰 사각형을 그리는 기본 시각화 로직을 구현했습니다.
- **(2일차) 기능 함수화 및 UI 개발:**
    - API 요청, 이미지 드로잉, 텍스트 결과 포매팅 로직을 각각의 독립된 함수로 분리하여 코드 구조를 개선했습니다.
    - `gradio`를 사용하여 이미지 URL 입력창, 기능 선택 체크박스, 동적 옵션, 결과 이미지 및 텍스트 출력창을 포함한 완성도 높은 웹 UI를 구축했습니다.
    - 최종적으로 사용자가 URL을 넣고 '전송' 버튼을 누르면, 선택된 모든 분석이 수행되고 시각/텍스트 결과가 한 화면에 표시되는 통합 이미지 분석 서비스를 완성했습니다.

## 6. 학습 정리

- **클라우드 AI의 힘:** 복잡한 컴퓨터 비전 모델을 직접 학습시키지 않고도, 강력한 상용 API를 활용하여 짧은 시간에 고성능 이미지 분석 기능을 구현할 수 있음을 경험했습니다.
- **API 기반 개발 능력:** REST API 명세를 이해하고, `requests` 라이브러리를 통해 원하는 기능과 옵션을 파라미터로 제어하며 서버와 통신하는 실질적인 개발 능력을 길렀습니다.
- **데이터와 시각화의 결합:** API로부터 받은 정형 데이터(JSON)를 해석하여 이미지라는 비정형 데이터 위에 의미 있는 정보(바운딩 박스, 라벨)로 시각화하는 데이터 처리 및 표현 능력을 향상시켰습니다.
- **신속한 프로토타이핑:** `gradio`를 활용하여 AI 기반 서비스의 프로토타입을 빠르고 효율적으로 구축하는 방법을 습득했으며, 이를 통해 아이디어를 실제 동작하는 애플리케이션으로 신속하게 전환할 수 있음을 확인했습니다.
