# Azure AI 기반 문서 자동화 처리 프로젝트

## 1. 학습 목표

- **Azure AI 서비스 활용:** Azure Document Intelligence(문서 분석)와 Azure AI Language(자연어 처리) 서비스를 사용하여 다양한 형식의 문서에서 정보를 추출하는 방법을 학습합니다.
- **사전 구축 모델 vs. 사용자 지정 모델:** 영수증, 인보이스 등 정형화된 문서를 위한 사전 구축 모델과 특정 양식에 특화된 사용자 지정 모델의 사용법 및 차이점을 이해합니다.
- **AI 모델 훈련 및 배포:** 사용자 지정 모델(Document Intelligence, Custom NER)을 만들기 위해 데이터를 준비하고, Language Studio에서 레이블을 지정하며, 모델을 훈련하고 배포하는 전체 과정을 경험합니다.
- **SDK 및 REST API 활용:** Azure AI 서비스와 상호작용하기 위해 Python SDK(`DocumentAnalysisClient`)와 REST API(`requests`)를 모두 사용하여 동기 및 비동기 방식으로 API를 호출하는 기술을 익힙니다.
- **비정형 데이터 처리:** 이미지, PDF뿐만 아니라 구조화되지 않은 장문 텍스트(계약서 등)에서 핵심 개체(Entity)를 인식하고 추출하는 Custom NER(사용자 지정 명명된 엔터티 인식) 기술을 습득합니다.

## 2. 프로젝트 개요

이 프로젝트는 수동으로 처리하던 다양한 비즈니스 문서를 자동화하는 AI 솔루션을 구축하는 것을 목표로 합니다. 3일간의 과정을 통해, 간단한 영수증 분석부터 복잡한 계약서의 핵심 정보 추출까지 점진적으로 발전하는 문서 이해(Document Intelligence) 기술을 다룹니다. 첫째 날에는 사전 구축된 모델을 사용하여 일반적인 문서를 분석하고, 둘째 날에는 특정 양식(인보이스)을 학습하는 사용자 지정 모델을 구축합니다. 마지막 날에는 정해진 양식이 없는 비정형 텍스트에서 필요한 정보만 정확히 찾아내는 Custom NER 모델을 구현하여, 모든 종류의 문서 처리 자동화에 대한 기반을 마련합니다.

## 3. 파일 구성 및 설명

- **`20250625_dl_7.ipynb` (1일차)**: Document Intelligence의 사전 구축 모델(`prebuilt-receipt`)을 사용하여 이미지 형태의 영수증에서 항목, 가격 등 주요 정보를 추출하고 시각화하는 방법을 다룹니다.
- **`20250626_di_7.ipynb` (2일차)**: 특정 양식(인보이스)을 분석하기 위해 Document Intelligence Studio에서 데이터를 레���블링하고, 이를 기반으로 사용자 지정 모델을 훈련시켜 새로운 인보이스 문서의 정보를 추출합니다.
- **`20250627_di_7.ipynb` (3일차)**: Azure AI Language의 Custom NER 기능을 사용하여, 정해진 양식이 없는 대출 계약서 텍스트에서 '대출자 이름', '대출 금액' 등 사전에 정의한 사용자 지정 개체를 인식하고 추출하는 방법을 학습합니다.

## 4. 서비스 설계

이 프로젝트는 문서의 종류와 정형화 수준에 따라 각기 다른 AI 분석 파이프라인을 적용합니다.

1.  **(1일차) 사전 구축 모델 파이프라인:**
    - 사용자가 영수증 이미지 URL을 제공합니다.
    - Python SDK(`DocumentAnalysisClient`)를 사용하여 `prebuilt-receipt` 모델로 분석을 요청합니다.
    - API는 분석 결과를 JSON 형태로 반환하며, 여기서 key-value 쌍, 테이블 정보 등을 파싱합니다.
    - 추출된 정보를 출력하고, `matplotlib`과 `Pillow`을 이용해 원본 이미지에 경계 상자(bounding box)를 그려 시각화합니다.
2.  **(2일차) 사용자 지정 문서 분석 모델 파이프라인:**
    - Azure Storage에 학습용 문서(예: 인보이스 PDF)들을 업로드합니다.
    - Document Intelligence Studio에서 각 문서의 필드(고객명, 총액 등)에 레이블을 ��정합니다.
    - SDK(`DocumentModelAdministrationClient`)를 통해 레이블링된 데이터로 사용자 지정 모델을 훈련합니다.
    - 훈련된 모델을 사용하여 새로운 인보이스 문서를 분석하고, 지정된 필드 값을 정확히 추출합니다.
3.  **(3일차) 사용자 지정 개체 인식(NER) 파이프라인:**
    - Language Studio에서 텍스트 데이터(예: 계약서)에 '대출자', '대출금액' 등 필요한 개체에 레이블을 지정합니다.
    - Custom NER 모델을 훈련하고 배포합니다.
    - REST API를 사용하여 분석할 텍스트로 비동기 분석 작업을 제출합니다.
    - 작업 상태를 주기적으로 폴링(polling)하여 'succeeded' 상태가 되면, 최종 결과 URL로 다시 요청을 보내 추출된 엔터티 목록과 신뢰도 점수를 얻습니다.

## 5. 주요 실행 과정 및 결과

- **(1일차) 영수증 분석:** `prebuilt-receipt` 모델을 사용하여 영수증 이미지에서 모든 구매 항목과 총 결제 금액을 성공적으로 추출하고, 각 항목의 위치를 원본 이미지에 시각화했습니다.
- **(2일차) 맞춤형 인보이스 분석:** 다수의 샘플 인보이스를 학습시킨 사용자 지정 모델을 통해, 이전에 보지 못한 새로운 인보이스에서 'InvoiceId', 'CustomerName', 'Total' 등의 필드를 95% 이상의 높은 정확도로 추출해냈습니다.
- **(3일차) 계약서 핵심 정보 추출:** 대출 계약서 전문을 학습한 Custom NER 모델을 통해, 비정형 텍스트 내에서 'Casey Jensen'을 'BorrowerName'으로, '$192,989.00'을 'LoanAmountNumbers'로 정확하게 식별하고 추출하는 데 성공했습니다.

## 6. 학습 정리

- **문제 해결을 위한 AI 도구 선택:** 문서의 정형화 수준에 따라 Document Intelligence의 사전 구축 모델, 사용자 지정 모델, 또는 AI Language의 Custom NER 중 가장 적합한 도구를 선택하고 활용하는 능력을 길렀습니다.
- **End-to-End AI 모델 구축 경험:** 데이터 준비 및 레이블링부터 모델 훈련, 배포, 그리고 실제 데이터에 대한 추론까지 이어지는 AI 모델 개발의 전체 사이클을 직접 경험했습니다.
- **다양한 API 상호작용:** Python SDK를 활용한 간편한 동기 방식 호출과, 대규모 작업을 위한 REST API 기반의 비동기 폴링 방식을 모두 다루어보며 상황에 맞는 API 연동 전략을 수립하는 능력을 향상시켰습니다.
- **문서 자동화의 가치:** 이 프로젝트를 통해 단순 반복적인 문서 처리 업무를 AI를 통해 자동화함으로써, 비즈니스 효율성을 극대화하고 고부가가치 업무에 집중할 수 있는 기술적 기반을 마련했습니다.
